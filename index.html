<html>
<head>
	<meta charset="utf-8" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.js"></script>
	<script src="https://cdn.steemjs.com/lib/latest/steem.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.css"/>
</head>

<body>

	<div class="ui two column  centered grid">
		<div class="column">
			<p>
			<h3 class="ui header">Type your reward in Steem Dollar (as displayed on Steemit and Busy)</h3>
			<div class="ui input" >
				<input placeholder="Type your reward..." type="text" id="reward">
			</div>
			
			</p>
			<div class="ui divider"></div>
			<table class="ui celled definition table">

			<thead>
				<tr>
					<th></th>
					<th colspan="2" style="text-align: center">50/50</th>
					<th style="text-align: center">100% STEEM POWER</th>
				</tr>
				<tr>
					<th></th>
					<th style="text-align: center" >50% SBD </th>
					<th style="text-align: center">50% STEEM POWER</th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				<tr>
				<td>USD Value</td>
				<td style="text-align: center" class="sbd_part">0</td>
				<td style="text-align: center" class="dollar_part">0</td>
				<td style="text-align:center" class="total-100">0</td>
				</tr>
				<tr>
				<td >Total USD</td>
				<td colspan="2" style="text-align: center"  class="total-50-50">0</td>
				<td style="text-align:center" class="total-100">0</td>
                </tr>
				<tr>
				<td>STEEM Value</td>
				<td style="text-align: center" class="sbd_reinvested">0</td>
				<td style="text-align: center" class="steem">0</td>
				<td style="text-align:center" class="total-100-insteem">0</td>
				</tr>
				<tr>
				<td>Total STEEM POWER</td>
				<td colspan="2" style="text-align:center" class="total-50-50-insteem">0</td>
				<td style="text-align:center" class="total-100-insteem">0</td>
                </tr>
			</tbody>
			</table>

			
			<div class="ui divider"></div>
			<h3 class="ui header">50/50 reward</h3>
			<p>
			<span><b>SBD Price : </b></span><span class="sbd_price">0</span> <span>US Dollar(s)</span>
			</p>
			<p>
			<span><b>STEEM Price (internal market) : </b></span><span class="Steem_internalmarket_price">0</span> <span>STEEM</span>
			</p>
			<p>
			<span><b>STEEM Price (media price) : </b></span><span class="steem_price">0</span> <span>STEEM</span>
			</p>
			<br/>
			<p>
			<span><b>50% Steem dollars real value</b> : </span><span class="sbd_part">0</span> <span>US Dollar(s)</span> (<span class="sbd_reinvested">0</span> <span> STEEM</span>)
			</p>
			<ul><b>(Reward In Steem Dollar / 2) x Steem Dollar Price</b> :
			<span>(<span class="total-100">0</span>/2)*<span class="sbd_price">0</span> = <span class="sbd_part">0</span></ul>
			</p>
			<p>
			<span><b>50% Steem dollars in STEEM (via internal market)</b> : </span><span class="sbd_reinvested">0</span> <span> STEEM</span>
			</p>
			<p>
			<span><b>50% Steem Power real value</b> : </span><span class="dollar_part">0</span> <span>US Dollar(s)</span>
			</p>
			<ul><b>Reward In Steem Dollar / 2</b> :
			<span><span class="total-100">0</span>/2 = <span class="dollar_part">0</span></ul>
			<p>
			<span><b>Total </b>: </span><span class="total-50-50">0</span> <span>US Dollar(s)</span> / <span class="total-50-50-insteem">0</span> <span>STEEM Power</span> 
			<ul><b>Steem Dollars Real Value + Steem Power Real Value</b> : 
			<span class="sbd_part">0</span> + <span class="dollar_part">0</span></ul>
			</p>
			<div class="ui divider"></div>
			<h3 class="ui header">100% Steem Power</h3>
			<span><b>Total </b>:</span> <span class="total-100">0</span> <span>US Dollar(s)</span> / <span class="total-100-insteem">0</span> <span>STEEM Power</span> 
<br><br><br><br>
<div class="ui floating message">
  <p>If you appreciate my work as a Steem witness, you can support me by voting for me (<a href="https://v2.steemconnect.com/sign/account-witness-vote?witness=evildido&approve=1">approve me</a>).
</p>
</div>

		</div>


	</div>







<script>
$(document).ready(function() {
	steem.api.setOptions({ url: 'https://api.steemit.com' });
	$.get('https://api.coinmarketcap.com/v1/ticker/steem-dollars/', function(data) {
		sessionStorage.setItem("sbd_price",data[0].price_usd);
		console.log("SBD price loaded");
		sbd_price = Number(sessionStorage.getItem("sbd_price")).toFixed(2);
		$(".sbd_price").html(Number(sessionStorage.getItem("sbd_price")).toFixed(2)); 
	});
	steem.api.getOrderBook(1, function(err, result) {
		sessionStorage.setItem("Steem_internalmarket_price",Number(result.asks[0].real_price).toFixed(2));
		$(".Steem_internalmarket_price").html(Number(sessionStorage.getItem("Steem_internalmarket_price")).toFixed(2));
	});	
	steem.api.getCurrentMedianHistoryPrice(function(err, result) {
		regex = /([0-9].*\.[0-9]{3})/g;
		sessionStorage.setItem("quote", regex.exec(result.quote)[0]);
		regex = /([0-9].*\.[0-9]{3})/g;	
  		sessionStorage.setItem("base", regex.exec(result.base)[0]);	
  		steem_price = sessionStorage.getItem("base") / sessionStorage.getItem("quote");
  		sessionStorage.setItem("steem_price",steem_price);
  		$(".steem_price").html(Number(sessionStorage.getItem("steem_price")).toFixed(2));
	});
});
	$("#reward").on("keyup", function() {
		sbd_part = (Number.parseFloat(this.value)/2) * sessionStorage.getItem("sbd_price");
		dollar_part = (Number.parseFloat(this.value)/2);
		$(".sbd_part").html(Number(sbd_part).toFixed(2));
		$(".dollar_part").html(Number(dollar_part).toFixed(2));
		$(".total-50-50").html(Number(dollar_part + sbd_part).toFixed(2));
		$(".total-100").html(Number(this.value).toFixed(2));
		
		
		console.log("sbdSteem Price " + sessionStorage.getItem("Steem_internalmarket_price"));
		console.log("SBD part " + Number.parseFloat(this.value)/2  + " to steem : "+ Number.parseFloat(this.value)/2/sessionStorage.getItem("Steem_internalmarket_price"));
		console.log("STEEM part : "+ (Number.parseFloat(this.value)/2/sessionStorage.getItem("steem_price")));
		
		
		
		
		reward_5050_insteem = ((Number.parseFloat(this.value)/2)/sessionStorage.getItem("Steem_internalmarket_price")) + ((Number.parseFloat(this.value)/2)/sessionStorage.getItem("steem_price"));
		reward_100_insteem = Number.parseFloat(this.value)/sessionStorage.getItem("steem_price");
		$(".sbd_reinvested").html(Number(Number.parseFloat(this.value)/2/sessionStorage.getItem("Steem_internalmarket_price")).toFixed(2));
		$(".steem").html(Number((Number.parseFloat(this.value)/2)/sessionStorage.getItem("steem_price")).toFixed(2));
		$(".total-50-50-insteem").html(Number(reward_5050_insteem).toFixed(2));
		$(".total-100-insteem").html(Number(reward_100_insteem).toFixed(2));
		
	});
    </script>
</body>




</html> 
w
